{
    "type": "multi-process-component",
    "identifier": {
        "namespace": "lifebitai",
        "name": "twas_vcf"
    },
    "description": "Pipeline for transcriptome-wide association analysis using PTWAS/GAMBIT software. This version has a .vcf input file.",
    "processes": [
        "transform_gwas_vcf",
        "add_annotations",
        "ptwas_scan"
    ],
    "resources": [{
        "process" :  "transform_gwas_vcf",
        "cpus": 1,
        "memory": "6.GB",
        "disk" : "30.GB",
      },{
        "process" :  "add_annotations",
        "cpus": 1,
        "memory": "6.GB",
        "disk" : "30.GB",
      },{
        "process" :  "ptwas_scan",
        "cpus": 1,
        "memory": "6.GB",
        "disk" : "60.GB",
      }],
    "errors":[{
        "process" :  "transform_gwas_vcf",
        "errorStrategy": "retry",
        "maxRetries": 9
      },{
        "process" :  "add_annotations",
        "errorStrategy": "retry",
        "maxRetries": 9
      },{
        "process" :  "ptwas_scan",
        "errorStrategy": "retry",
        "maxRetries": 9
      }],
    "containers": [
        {
            "process": "transform_gwas_vcf",
            "name": "quay.io/lifebitai/gwas",
            "tag": "1.2dev"
        },
        {
            "process": "add_annotations",
            "name": "quay.io/lifebitai/anno",
            "tag": "1.0.1"
        },
        {
            "process": "ptwas_scan",
            "name": "quay.io/lifebitai/ptwas",
            "tag": "1.0.0_089aa00"
        }
    ],
    "scripts": [
        {
            "name": "calculate_z.py",
            "source": {
                "type": "url",
                "content": "https://raw.githubusercontent.com/lifebit-ai/bi-twas-nf/dev/bin/calculate_z.py"
            }
        },{
            "name": "run.sh",
            "source": {
                "type": "url",
                "content": "https://raw.githubusercontent.com/lifebit-ai/bi-twas-nf/dev/bin/run.sh"
            }
        },
      ],
    "inputs": {
        "input1": {
            "label": "ch_gene_annotations",
            "elements": [
            {
                "id": "gene_annotations",
                "type": "path",
                "pattern": "*.txt.gz",
                "checkIfExists": true
            }
            ]
        },
        "input2": {
            "label": "ch_codon_file",
            "elements": [
            {
                "id": "codon_file",
                "type": "path",
                "pattern": "*.txt",
                "checkIfExists": true
            }
            ]
        },
        "input3": {
            "label": "ch_priority_file",
            "elements": [
            {
                "id": "priority_file",
                "type": "path",
                "pattern": "*.txt",
                "checkIfExists": true
            }
            ]
        },
        "input4": {
            "label": "ch_ref_fasta",
            "elements": [
            {
                "id": "ref_fasta",
                "type": "path",
                "pattern": "*.fasta",
                "checkIfExists": true
            }
            ]
        },
        "input5": {
            "label": "ch_ref_fasta_index",
            "elements": [
            {
                "id": "ref_fasta_index",
                "type": "path",
                "pattern": "*.fasta.fai",
                "checkIfExists": true
            }
            ]
        },
        "input6": {
            "label": "ch_ld_reference",
            "elements": [
            {
                "id": "ld_reference",
                "type": "path",
                "pattern": "*.gambit.tgz",
                "checkIfExists": true
            }
            ]
        },
        "input7": {
            "label": "ch_eqtl_weights",
            "elements": [
            {
                "id": "eqtl_weights",
                "type": "path",
                "pattern": "*.txt.gz",
                "checkIfExists": true
            }
            ]
        },
        "input8": {
            "label": "ch_gwas_sumstats",
            "elements": [
            {
                "id": "cgwas_sumstats",
                "type": "path",
                "pattern": "*.vcf*",
                "checkIfExists": true
            }
            ]
        }
    }
    "parameters":
    {
        "parameter1": {
            "id": "outdir",
            "type": "path",
            "description": "Output directory for the results",
            "required": false,
            "default": "results/"
          }, 
          "parameter2": {
            "id": "gambit_exec_path",
            "type": "path",
            "description": "Path to the gambit executables",
            "required": false,
            "default": "/GAMBIT/bin/GAMBIT"
          }, 
          "parameter3": {
            "id": "3",
            "type": "number",
            "description": "Sample size of GWAS study",
            "required": true
          }, 
          "parameter4": {
            "id": "annotate_vcf",
            "type": "boolean",
            "description": "Whether the .vcf files should be annotated",
            "required": false,
            "default": true
          }
    }
    "outputs": {
        "output1": {
          "label": "stratified_out",
          "elements": [{
            "id": "stratified_out",
            "type": "path",
            "pattern": "*stratified_out.txt"
          }]
        },
        "output2": {
            "label": "summary_out",
            "elements": [{
              "id": "summary_out",
              "type": "path",
              "pattern": "*summary_out.txt"
            }]
          }
    }
}